<%
#header_str = render(:partial => '/gw/public/prop_genre_common/header')
header_str = render(:partial => '/gw/public/schedules/schedule_bt_box', :locals=>{:d=>Date.today, :mode=>'month', :genre=>@genre})
header_str = header_str.gsub(/\r\n|\r|\n/, "")  # デザインからの依頼で、改行を削除している。
parent_groups = Gw::PropOther.get_parent_groups

return_str = link_to('スケジューラーへ戻る', "/gw/schedule_props/show_week?s_genre=#{@genre}&cls=#{@cls}")
#admin, editor, reader = @item.admin_editor_reader(:name) # 施設管理所属、予約可能所属、照会可能所属を返す関数

images = @item.images
images_flg = true # 先頭の画像のみ、見取り図と判断させて別の箇所に表示させる。
images_t = ''
images_s = ''
images.each do |img|
  images_s += %Q(<img src="#{img.path}" alt="#{img.note}" />)
end

cls = Gw.yaml_to_array_for_select("gw_prop_other_type_ids").rassoc(@item.type_id)

#state = Gw.yaml_to_array_for_select("gw_prop_other_states")
#state_array = state.rassoc(@item.state)
#edit_state = Gw.yaml_to_array_for_select("t1f0_kyoka_fuka")
reserved_state = Gw.yaml_to_array_for_select("t1f0_kyoka_fuka")

header = <<-EOL
#{render :partial => '/gw/public/prop_genre_common/piece_header'}
EOL

body = {:header => header_str, :body=> <<-EOL }
#{div_notice}
<div class="editingBox">
<span class="btEdit">
#{ link_to_edit @item.id, nil, :qs=>"cls=#{@cls}" if @is_admin }
</span>
<span class="btDestroy">
#{ link_to_destroy @item.id, nil, :qs=>"cls=#{@cls}" if @is_admin }
</span>
<span class="btAttach">
#{ link_to '添付', "/gw/prop_#{@genre}s/#{@item.id}/upload?cls=#{@cls}" if @is_admin }
</span>
</div>

<div class="imgBox#{images.length == 0 ? " noImage" : ""}">
#{images_s}
</div>

<div class="tableBox">
<table class="show rentDetails">
<th>予約</th>
<td>#{reserved_state[@item.reserved_state][0]}</td>
</tr>
<tr><th>表示順</th>
  <td>#{@item.sort_no}</td>
</tr><tr>
<th>名称</th>
<td>#{@item.name}</td>
</tr><tr>
<th>種別</th>
<td>#{cls[0]}</td>
</tr><tr>
<th>備考</th>
<td>#{br(@item.comment)}</td>
</tr><tr>
<th>作成日</th>
<td>#{@item.created_at.strftime('%Y-%m-%d %H:%M')}</td>
</tr><tr>
<th>更新日</th>
<td>#{@item.updated_at.strftime('%Y-%m-%d %H:%M')}</td>
</tr><tr>
<th>管理区分</th>
<td>一般</td>
</tr>
<tr>
<th>施設管理所属</th>
<td>#{Gw.join [@item.admin(:show, parent_groups)], '<br />'}</td>
</tr>
<tr>
<th>予約可能所属</th>
<td>#{Gw.join [@item.editor(:show, parent_groups)], '<br />'}</td>
</tr>
<tr>
<th>照会可能所属</th>
<td>#{Gw.join [@item.reader(:show, parent_groups)], '<br />'}</td>
</tr>
</tr>
</table>

</div>
<div class="imgBox2">
#{images_t}
</div>
<br class="clear" />
<div class="btReturn">
#{return_str}
</div>
EOL

concat hhbff_struct(:prop, :show, :header=>header, :body=>body)
%>