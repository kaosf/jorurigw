<%

hidden_roles_json_s = hidden_field_tag('init[schedule_roles_json]',
  (params[:item] && params[:item][:schedule_roles_json] ? params[:item][:schedule_roles_json] : nz(@roles_json) ))

concat "<!--#{@roles_json}-->"

concat hidden_roles_json_s

  u = Site::user_group
  ucls = 2
  uid = u.id
  uname = u.name

concat <<-EOL
#{hidden_field_tag('init[ucls]', ucls)}
#{hidden_field_tag('init[uid]', uid)}
#{hidden_field_tag('init[uname]', uname)}
EOL


f.fields_for :schedule_roles do |schedule_role|
	concat <<-EOL
<table border="0">
<tr>
<td class="roleChange">
#{select_tag 'item[schedule_roles][uid]', Gw.options_for_select(
  System::Group.get_group_select('', '', :add_conditions=>"level_no = 3"), Site.user_group.group_id, :title=>1), :size=>10,
  :style => 'width:300px;', :ondblclick => 'add_roles()', :multiple => true}
</td>
<td>
#{button_to_function '追加 →', 'add_roles()'}<br /><br />
#{button_to_function '← 削除', 'del_roles()'}
</td>
<td>
#{select_tag 'item[schedule_roles_add_buf]', [], :size=>10, :style => 'width:300px;', :ondblclick => 'del_roles()', :multiple => true}
#{hidden_field_tag 'item[schedule_roles_json]', ''}
</table>
EOL
end


%>

